<app-navbar></app-navbar>

<ion-content>
  <!-- <ion-content  (document:keydown)="handleKeydown($event)"> -->
  <ion-split-pane contentId="main-content" when="sm">

    <app-sidebar></app-sidebar>


    <ion-content id="main-content">

      <app-search-supplier *ngIf="isSupplierFound==false"></app-search-supplier>

      <form class="inputForm" #myForm="ngForm" *ngIf="isSupplierFound">

        <h1>Inventory Return</h1>

        <div class="item-container">
          <ion-item (click)="changeSupplier()">
            <b>Supplier:</b> {{SupplierName}} <b>({{this.returnData.SupplierID}})</b>
            <input type="hidden" [(ngModel)]="returnData.SupplierID" name="returnData.SupplierID" required>
          </ion-item>
        </div>

        <div>
          <b>StoreID:</b> {{returnData.StoreID}} | <mat-label><b>Lock Supplier</b></mat-label>
          <mat-checkbox [checked]="lockSupplier === true" (change)="lockSupplier = !lockSupplier">
          </mat-checkbox>
        </div>

        <div class="container" *ngIf="returnData.ProductID">
          <div class="info">
            <div class="left-info">
              <div><b>MinCostStoreID:</b></div>
              <div><b>MaxCostStoreID:</b></div>
            </div>
            <div class="right-info">
              <div>{{MinCostStore}}</div>
              <div>{{MaxCostStore}}</div>
            </div>

            <div class="left-info">
              <div><b>MinCost:</b></div>
              <div><b>MaxCost:</b></div>
            </div>
            <div class="right-info">
              <div>${{MinCost | number:'1.2-2'}}</div>
              <div>${{MaxCost | number:'1.2-2'}}</div>
            </div>
          </div>

          <div class="info">
            <div class="left-info">
              <div><b>RegPrice:</b></div>
            </div>
            <div class="right-info">
              <div>${{RegPrice | number:'1.2-2'}}</div>
            </div>
          </div>
          <div><b>Cost with 25% Markup: ${{ getCostWithMargin(RegPrice) | number:'1.2-2' }}</b></div>
        </div>

        <div class="topInput">
          <mat-form-field appearance="fill">
            <mat-label>ProductID: {{NormalizedID}}</mat-label>
            <input matInput type="string" [(ngModel)]="returnData.ProductID" name="returnData.ProductID"
              (ngModelChange)="onProductIDChange()" #inputElement required>
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-label>Return Quantity</mat-label>
            <input matInput type="number" [(ngModel)]="returnData.ReturnQuantity" name="returnData.ReturnQuantity"
              required>
          </mat-form-field>
        </div>

        <div>
          <mat-form-field appearance="fill">
            <mat-label>ProductName</mat-label>
            <input matInput type="string" [(ngModel)]="returnData.ProductName" name="returnData.ProductName" required>
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-label>UnitCost</mat-label>
            <input matInput type="number" [(ngModel)]="returnData.UnitCost" name="returnData.UnitCost" [disabled]="foundPO" required>
          </mat-form-field>
        </div>

        <mat-label>Tax(13%)</mat-label>
        <mat-checkbox [checked]="returnData.Tax === 1" (change)="checkTax($event)">
        </mat-checkbox>

        <div>
          <button mat-raised-button color="primary" (click)="submitReturnItem()"
            [disabled]="myForm.invalid || this.returnData.ProductID==''">
            Submit
          </button>

          <button mat-raised-button color="primary" (click)="reset()">
            Reset
          </button>
        </div>

      </form>


      <div class="comment">
        <p>
          <b>Supplier:</b>
          This field will automatically populate based on the ProductID entered.
          <!-- If you manually select a supplier, the "Lock Supplier" checkbox will be checked, and automatic supplier lookup
          based on ProductID will be disabled. -->
        </p>
        <p>
          <b>ProductID:</b>
          Enter the ProductID of the item you wish to return.
          Upon entering a valid ProductID, the system will automatically search for and populate the Supplier field.
          If the "Lock Supplier" checkbox is checked, entering a ProductID will not trigger an automatic supplier
          lookup.
        </p>
        <p>
          <b>ProductName:</b>
          Note: The ProductName field will be automatically filled based on the ProductID.
          If it does not display, it means the product does not exist in our database. Please enter the name manually.
        </p>
        <p>
          <b>Return Quantity:</b>
          Enter the quantity of the product you are returning.
        </p>
        <p>
          <b>Submit:</b>
          Click the "Submit" button to submit the form.
        </p>
        <p>
          <b>Reset:</b>
          Click the "Reset" button to clear all fields and reset the form to its initial state.
        </p>
      </div>


    </ion-content>



  </ion-split-pane>

</ion-content>